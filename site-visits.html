<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Visual Diary | Anant Aggarwal Architects</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,400&family=DM+Sans:wght@300;400;600&display=swap" rel="stylesheet">

    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

    <style>
        :root {
            --bg-color: #f8f9fa;
            --accent: #c9b29a;
            --fg: #222;
            --font-serif: 'Cormorant Garamond', serif;
            --font-sans: 'DM Sans', sans-serif;
        }

        body {
            font-family: var(--font-sans);
            background-color: var(--bg-color);
            color: var(--fg);
            overflow-x: hidden;
            background-image: radial-gradient(#e5e5e5 1px, transparent 1px);
            background-size: 30px 30px;
        }

        .hidden { display: none !important; }

        /* --- LANDING LIST --- */
        .index-container {
            min-height: 100vh; width: 100vw; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 10;
            padding: 100px 20px 40px;
        }
        .index-header {
            font-family: var(--font-serif); font-size: 1rem; letter-spacing: 0.3em;
            text-transform: uppercase; color: #888; margin-bottom: 2rem;
            border-bottom: 1px solid #ddd; padding-bottom: 1rem;
        }
        .diary-list { list-style: none; padding: 0; text-align: center; }
        .diary-item { margin-bottom: 1.5rem; cursor: pointer; transition: all 0.4s ease; }
        
        .diary-link {
            font-family: var(--font-serif); font-size: 2.5rem; color: #222;
            text-decoration: none; line-height: 1.1; position: relative; display: inline-block;
        }
        .diary-num {
            font-family: var(--font-sans); font-size: 0.8rem; color: var(--accent);
            font-weight: 600; display: block; margin-bottom: 5px;
        }

        @media(min-width:768px){ 
            .diary-link { font-size: 4rem; line-height: 1; } 
            .diary-item { margin-bottom: 2rem; }
            .diary-num { position: absolute; top: 5px; left: -30px; margin-bottom: 0; opacity: 0; transform: translateX(10px); transition: all 0.3s ease; }
            .diary-item:hover .diary-link { color: var(--accent); transform: scale(1.05); font-style: italic; }
            .diary-item:hover .diary-num { opacity: 1; transform: translateX(0); }
        }

        /* --- BOOK STAGE --- */
        .book-stage {
            height: 100vh; width: 100vw; display: flex; flex-direction: column;
            justify-content: center; align-items: center; perspective: 2500px;
            position: fixed; top: 0; left: 0; z-index: 20; background: #fff;
        }
        
        .book-transform-wrapper {
            position: relative; transform-style: preserve-3d;
            transform: rotateX(0deg); 
            width: 100%; height: 100%; display: flex; justify-content: center; align-items: center;
        }
        @media(min-width:768px){
            .book-transform-wrapper { transform: rotateX(10deg) translateY(-20px); }
        }

        /* --- UI CONTROLS --- */
        #global-exit-btn {
            position: fixed; top: 20px; right: 20px; z-index: 9999;
            background: #fff; padding: 8px 16px; border-radius: 30px;
            border: 1px solid #ddd; cursor: pointer;
            font-family: var(--font-sans); text-transform: uppercase;
            letter-spacing: 0.1em; font-size: 0.7rem; color: #222;
            display: flex; align-items: center; gap: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .toolbar {
            position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%);
            display: flex; align-items: center; gap: 15px;
            background: rgba(255, 255, 255, 0.95); padding: 8px 20px;
            border-radius: 50px; box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px); z-index: 100; border: 1px solid #eee;
        }
        .tool-btn { background: none; border: none; font-size: 1.2rem; cursor: pointer; color: #333; }
        .tool-btn:disabled { opacity: 0.3; }

        /* --- PAGE STYLES --- */
        .my-page { background-color: #fff; overflow: hidden; position: relative; }
        .my-page.--hard { background-color: #1a1a1a; border: 1px solid #333; }
        
        .my-page::after {
            content: ''; position: absolute; top: 10px; bottom: 10px; width: 15px; z-index: 50;
            background: repeating-linear-gradient(-45deg, transparent 0, transparent 8px, #333 8px, #888 9px, #333 10px, transparent 10px, transparent 16px);
            pointer-events: none;
        }
        @media(max-width:767px){ .my-page::after { left: 0; border-left: 2px dotted rgba(0,0,0,0.2); width: 12px; } }
        @media(min-width:768px){
            .my-page:nth-child(even)::after { right: 0; border-right: 2px dotted rgba(0,0,0,0.2); }
            .my-page:nth-child(odd)::after { left: 0; border-left: 2px dotted rgba(0,0,0,0.2); }
        }

        /* --- TEXT ANIMATION STYLES --- */
        .anim-element {
            opacity: 0;
            transform: translateY(15px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        /* Delay slightly so it plays AFTER page flip */
        .active-page .anim-element {
            opacity: 1;
            transform: translateY(0);
            transition-delay: 0.3s;
        }
        /* Specific delays for sequence */
        .active-page .anim-delay-1 { transition-delay: 0.4s; }
        .active-page .anim-delay-2 { transition-delay: 0.5s; }

        /* Content */
        .page-image-full { width: 100%; height: 100%; object-fit: contain; }
        .caption-box {
    position: absolute; 
    bottom: 0; 
    left: 0; 
    right: 0;
    background: rgba(255,255,255,0.6); 
    padding: 15px;
    border-top: 1px solid #eee; /* Visual separator */
    border-left: 3px solid var(--accent);
    z-index: 60;
}

        }
        .caption-box h3 { font-size: 0.65rem; letter-spacing: 0.1em; text-transform: uppercase; font-weight:700; margin-bottom: 3px; }
        .caption-box p { font-family: var(--font-serif); font-size: 0.85rem; font-style: italic; color: #555; line-height: 1.2; }

        .text-page-container { height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 1.5rem; background-color: #fdfbf7; }
        .cover-content { height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 1.5rem; border: 1px solid rgba(255,255,255,0.2); text-align: center; }
        .cover-title { font-family: var(--font-serif); font-size: 2.2rem; color: var(--accent); line-height: 1; margin-bottom: 0.5rem; } 
        @media(min-width:768px){ .cover-title { font-size: 3rem; } }
        .cover-sub { font-family: var(--font-sans); color: #888; font-size: 0.6rem; letter-spacing: 0.3em; text-transform: uppercase; }

        /* NAVBAR */
        .hamburger-box { width: 30px; height: 12px; display: flex; flex-direction: column; justify-content: space-between; cursor: pointer; transition: opacity 0.3s; }
        .h-line { width: 100%; height: 1px; background-color: #F0EBE0; transition: all 0.3s ease; }
        .glass-menu { position: fixed; top: 0; right: 0; height: 100vh; width: 100%; max-width: 450px; background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px); transform: translateX(100%); transition: transform 0.6s cubic-bezier(0.77, 0, 0.175, 1); z-index: 150; display: flex; flex-direction: column; justify-content: center; align-items: center; border-left: 1px solid rgba(255,255,255,0.1); }
        .menu-open { transform: translateX(0); }
        .menu-link { display: block; transform: translateX(50px); opacity: 0; transition: all 0.5s ease; color: white; }
        .menu-link.slide-in { transform: translateX(0); opacity: 1; }
        nav { transition: transform 0.4s ease-in-out; }
        .nav-hidden { transform: translateY(-100%); }
    </style>
</head>

<body>

    <div id="fs-menu" class="glass-menu text-[#F0EBE0] border-l border-white/10">
        <div class="absolute bottom-10 left-10 text-[100px] opacity-5 font-serif pointer-events-none select-none leading-none">∞</div>
        <div class="menu-links-container text-left w-full pl-20 flex flex-col gap-8 relative z-10">
            <div><a href="index.html" class="menu-link text-3xl md:text-4xl font-serif hover:text-gray-400">Home</a></div>
            <div><a href="about.html" class="menu-link text-3xl md:text-4xl font-serif hover:text-gray-400">About</a></div>
            <div><a href="projects.html" class="menu-link text-3xl md:text-4xl font-serif hover:text-gray-400">Projects</a></div>
            <div><a href="services.html" class="menu-link text-3xl md:text-4xl font-serif hover:text-gray-400">Services</a></div>
            <div><a href="contact.html" class="menu-link text-3xl md:text-4xl font-serif hover:text-gray-400">Contact</a></div>
        </div>
        <div id="menu-close" class="absolute top-10 right-10 cursor-pointer text-xs uppercase tracking-widest hover:opacity-70 z-50 flex items-center gap-2"><span>Close</span> <div class="w-4 h-[1px] bg-white"></div></div>
    </div>

    <nav id="main-nav" class="fixed top-0 left-0 w-full px-5 md:px-10 py-6 flex justify-between items-center z-50 mix-blend-difference text-[#F0EBE0]">
        <div class="text-xl font-bold tracking-widest uppercase cursor-pointer">ANANT AGRAWAL ARCHITECTS</div>
        <div id="menu-trigger" class="cursor-pointer group p-2">
            <div class="hamburger-box"><div class="h-line group-hover:bg-gray-400"></div><div class="h-line group-hover:bg-gray-400"></div></div>
        </div>
    </nav>

    <section id="landing-view" class="index-container">
        
        <div style="font-family: var(--font-serif); font-size: 1.5rem; margin-bottom: 2rem; font-style: italic;">Visual Diaries</div>
        <ul class="diary-list">
            <li class="diary-item" onclick="openDiary(0)"><div class="diary-link"><span class="diary-num">01</span>London Diary</div></li>
            <li class="diary-item" onclick="openDiary(1)"><div class="diary-link"><span class="diary-num">02</span>Cardiff Diary</div></li>
            <li class="diary-item" onclick="openDiary(2)"><div class="diary-link"><span class="diary-num">03</span>Paris Diary</div></li>
            <li class="diary-item" onclick="openDiary(3)"><div class="diary-link"><span class="diary-num">04</span>Zefco Diary</div></li>
        </ul>
    </section>

    <button id="global-exit-btn" class="hidden" onclick="closeDiary()">
        Close <i class="ph ph-x" style="font-size: 1rem;"></i>
    </button>

    <section id="book-view" class="book-stage hidden">
        <div class="book-transform-wrapper">
            <div id="flipbook"></div> 
        </div>
        <div class="toolbar">
            <button id="btnPrev" class="tool-btn"><i class="ph ph-caret-left"></i></button>
            <div style="font-size:0.7rem; color:#555; font-weight:600; padding:0 10px;" id="pageCount">Cover</div>
            <button id="btnNext" class="tool-btn"><i class="ph ph-caret-right"></i></button>
        </div>
    </section>

    <script src="https://cdn.jsdelivr.net/npm/page-flip/dist/js/page-flip.browser.js"></script>

    <script>
        // --- DATA (Revised to 30-50 words per intro) ---
        const diaries = [
            {
                id: "01", 
                city: "London", 
                // YOUR INTRO TEXT
                intro: "During my Sustainable Mega Buildings studies at Cardiff University’s Welsh School of Architecture, I joined Dr. Julie (Ann) Futcher on an advanced urban climate walk in London’s high-rise district, with Professors Tania Sharmin and Eshrar Latif. This honed my skills in analyzing tall buildings' impact on urban microclimates, enabling climate-responsive high-rise designs that optimize performance and comfort.", 
                
                images: [
                    { 
                        t: "Historic vs Modern Context", 
                        img: "london/20250403_104604.jpg", // Royal Exchange
                        desc: "The juxtaposition of the Royal Exchange’s classical portico against 22 Bishopsgate’s monolithic glass façade highlights the evolution of the City’s urban fabric. This contrast emphasizes the shift from thermal mass masonry to lightweight, high-performance skins, altering the local microclimate and wind patterns at street level."
                    },
                    { 
                        t: "Urban Climate Research", 
                        img: "london/Screenshot_20251201_140839_LinkedIn.jpg", // Group Photo
                        desc: "Field analysis with Dr. Julie Futcher and the research cohort. Conducting observational studies on urban microclimates is crucial for validating computational fluid dynamics (CFD) models. This engagement provides qualitative data on occupant comfort, bridging the gap between theoretical performance and the lived reality of high-density zones."
                    },
                    { 
                        t: "Form Follows Environment", 
                        img: "london/20250422_181807.jpg", // City Hall
                        desc: "The form of the former City Hall is driven by thermodynamic principles. Its spherical geometry minimizes surface area to reduce heat loss, while the stepped, overhanging floors provide passive solar shading. A prime example of high-tech sustainable architecture where form intrinsically follows environmental function."
                    },
                    { 
                        t: "Structural Expressionism", 
                        img: "london/20250403_114001.jpg", // Lloyd's Building
                        desc: "Richard Rogers’ Lloyd’s Building exemplifies the 'Inside-Out' ethos. By externalizing services—staircases, lifts, and ducts—the design creates a flexible, uninterrupted interior floor plate. The dynamic, layered façade actively modulates light and shadow, creating a complex aerodynamic profile that influences the immediate wind environment."
                    },
                    { 
                        t: "Biophilic Facades", 
                        img: "london/20250403_110824.jpg", // Living Wall
                        desc: "This extensive vertical living wall serves as an active biological cladding system. Beyond visual relief, it combats the urban heat island effect through evapotranspiration, improves local air quality by trapping particulate matter, and introduces biodiversity into the dense, mineral-heavy landscape of the city."
                    },
                    { 
                        t: "The Urban Canyon", 
                        img: "london/20250403_113413.jpg", // Sky View
                        desc: "A 'worm’s-eye' view of the urban canyon reveals the spatial compression caused by vertical densification. The converging glass towers reduce sky view factors, limiting direct sunlight at street level. This perspective underscores the need for high-reflectance materials to maximize daylight penetration into the public realm."
                    },
                    { 
                        t: "Aerodynamic Morphology", 
                        img: "london/20250403_112439.jpg", // Gherkin
                        desc: "30 St Mary Axe’s aerodynamic form reduces wind downdrafts, enhancing pedestrian comfort. Its diagrid structure allows for a column-free interior and fully glazed skin. In contrast, the angular geometry of The Scalpel creates distinct wind turbulence, showcasing how varying high-rise morphologies impact the urban microclimate."
                    }
                ]
            },
            {
                id: "02", 
                city: "Cardiff", 
                intro: "During my MSc Architectural Science studies at Cardiff University’s Welsh School of Architecture, I investigated the Grade-I-listed Pierhead Building (1897) in Cardiff Bay, guided by Matthew Jones, Dr. Simon Lannon, and Dr. Vicki Stevenson. Focusing on the Futures Gallery, I conducted post-occupancy monitoring and energy optimization, blending heritage preservation with sustainability for enhanced performance and comfort.", 
                images: [
                    { 
                        t: "Victorian Gothic Heritage", 
                        img: "cardiff/20250311_114247.jpg", // Exterior Wide Shot
                        desc: "The Grade-I listed Pierhead Building stands as a masterpiece of terracotta Victorian Gothic architecture. Its thermal mass masonry walls present unique challenges for modern energy retrofitting, requiring sensitive interventions that preserve the historic fabric while mitigating heat loss in the harsh maritime climate of Cardiff Bay." 
                    },
                    { 
                        t: "Research Cohort", 
                        img: "cardiff/Screenshot_20251201_140942_LinkedIn.jpg", // Group Photo
                        desc: "Collaborative fieldwork with the MSc Architectural Science cohort in front of the Pierhead. This site visit initiated the comprehensive environmental audit, establishing the baseline for our post-occupancy evaluation. The human element—understanding visitor flow and staff comfort—was central to our sustainability strategy." 
                    },
                    { 
                        t: "Internal Circulation", 
                        img: "cardiff/20250311_103342.jpg", // Interior Stairs
                        desc: "The grand staircase acts as a thermal chimney, influencing the building's stack effect ventilation. Our analysis focused on how vertical circulation spaces redistribute heat, identifying stratification patterns that could be leveraged for passive cooling in summer or heat recovery during winter months." 
                    },
                    { 
                        t: "Futures Gallery Occupancy", 
                        img: "cardiff/Screenshot_20251211_221115_LinkedIn.jpg", // Gallery Crowd
                        desc: "The Futures Gallery serves as a high-traffic exhibition space. We analyzed the impact of fluctuating visitor density on indoor air quality (IAQ) and thermal load. The study aimed to balance the preservation of sensitive exhibits with the comfort requirements of a modern, multipurpose public venue." 
                    },
                    { 
                        t: "Post-Occupancy Monitoring", 
                        img: "cardiff/Screenshot_20251211_221100_LinkedIn.jpg", // Hand with sensor
                        desc: "Utilizing rigorous environmental monitoring tools to measure surface temperatures and airflow rates. This data-driven approach allowed us to identify thermal bridges and infiltration points within the historic envelope, providing empirical evidence to support targeted retrofitting proposals for energy optimization." 
                    }
                ]
            },
            {
                id: "03", 
                city: "Paris", 
                intro: "During a Paris study trip with Cardiff University’s Environmental Design and Sustainable Megabuildings MSc cohorts, led by Profs. Emmanouil Perisoglou and Amalia Banteli, I explored Zefco’s low-carbon designs integrating beauty and sustainability. Collaborating with experts like Sarah O'Dwyer, Vicki Stevenson, and others, I honed skills in environmentally responsive architecture for future-proof solutions.", 
                images: [
                    { 
                        t: "The Urban Void", 
                        img: "paris/20250603_163748.jpg", // BNF Towers
                        desc: "Dominique Perrault’s Bibliothèque Nationale de France redefines the urban void. Four L-shaped glass towers frame a sunken forest, creating an inward-looking microclimate that isolates reading rooms from the city's noise. The minimal glass envelopes emphasize transparency while the central garden acts as the project’s green lung." 
                    },
                    { 
                        t: "Civic Transparency", 
                        img: "paris/20250604_122043.jpg", // Tribunal Interior
                        desc: "Renzo Piano’s Tribunal de Paris exemplifies institutional transparency through its light-filled atrium. The structural hierarchy, defined by slender white columns and extensive glazing, dematerializes the building’s mass. This passive solar design strategy maximizes daylight penetration, reducing artificial lighting loads while creating a welcoming civic space." 
                    },
                    { 
                        t: "Organic Verticality", 
                        img: "paris/20250604_101001(0).jpg", // UNIC Building
                        desc: "MAD Architects’ UNIC building in Clichy-Batignolles challenges the rigidity of the Parisian block with its sinuous, organic floor plates. The undulating terraces maximize views and solar access for residents, blurring the boundary between architecture and nature. It stands as a sculptural intervention in high-density vertical living." 
                    },
                    { 
                        t: "Sustainable Materiality", 
                        img: "paris/20250604_104202.jpg", // Clichy Green/Wood
                        desc: "A study in contrasting materiality within the eco-district. The juxtaposition of vertical timber slats against green metallic cladding highlights diverse approaches to sustainable facades. These skins are not merely aesthetic; they function as active rainscreens and shading devices, regulating thermal gain and promoting natural ventilation." 
                    },
                    { 
                        t: "Bio-Climatic Design", 
                        img: "paris/20250604_100941.jpg", // Green Tower
                        desc: "This residential tower integrates extensive vertical landscaping, functioning as a vertical garden city. The deep, planted balconies provide natural shading and evaporative cooling, mitigating the urban heat island effect. It represents a paradigm shift towards bio-climatic high-rise design where vegetation is integral to the building envelope." 
                    },
                    { 
                        t: "Passive Solar Shading", 
                        img: "paris/20250604_114310.jpg", // Angular Balconies
                        desc: "The sharp, angular geometry of these balconies optimizes passive solar shading while maintaining privacy. The use of warm, natural timber louvers contrasts with the concrete structure, softening the visual impact. This articulation creates a dynamic play of shadow and light, responsive to the shifting sun angles throughout the day." 
                    },
                    { 
                        t: "Structural Contrast", 
                        img: "paris/20250603_192333.jpg", // Louvre Pyramid
                        desc: "I.M. Pei’s Pyramid is a masterclass in structural tension and transparency. The cable-stayed glass structure creates a dialogue between the historic Renaissance palace and modern engineering. It serves as a luminous skylight for the subterranean lobby, demonstrating how minimal intervention can activate vast underground volumes." 
                },
                    { 
                        t: "Civic Transparency", 
                        img: "paris/20250604_122043.jpg", // Tribunal Interior
                        desc: "Renzo Piano’s Tribunal de Paris exemplifies institutional transparency through its light-filled atrium. The structural hierarchy, defined by slender white columns and extensive glazing, dematerializes the building’s mass. This passive solar design strategy maximizes daylight penetration, reducing artificial lighting loads while creating a welcoming civic space." 
                    },
                    { 
                        t: "Collaborative Fieldwork", 
                        img: "paris/IMG-20250612-WA0039.jpg", // Group Photo
                        desc: "Field study with the MSc cohorts and industry experts at the Tribunal de Paris. Engaging directly with these megastructures allowed us to critique the practical application of low-carbon design philosophies, bridging the gap between academic theory and the operational realities of large-scale sustainable architecture." 
                    },
                    { 
                        t: "Organic Verticality", 
                        img: "paris/20250604_101001(0).jpg", // UNIC Building
                        desc: "MAD Architects’ UNIC building in Clichy-Batignolles challenges the rigidity of the Parisian block with its sinuous, organic floor plates. The undulating terraces maximize views and solar access for residents, blurring the boundary between architecture and nature. It stands as a sculptural intervention in high-density vertical living." 
                    },
                    { 
                        t: "Bio-Climatic Design", 
                        img: "paris/20250604_100941.jpg", // Green Tower
                        desc: "This residential tower integrates extensive vertical landscaping, functioning as a vertical garden city. The deep, planted balconies provide natural shading and evaporative cooling, mitigating the urban heat island effect. It represents a paradigm shift towards bio-climatic high-rise design where vegetation is integral to the building envelope." 
                    },
                    { 
                        t: "Sustainable Materiality", 
                        img: "paris/20250604_104202.jpg", // Timber Facade
                        desc: "A study in contrasting materiality within the eco-district. The juxtaposition of vertical timber slats against green metallic cladding highlights diverse approaches to sustainable facades. These skins are not merely aesthetic; they function as active rainscreens and shading devices, regulating thermal gain and promoting natural ventilation." 
                    },
                    { 
                        t: "The Urban Void", 
                        img: "paris/20250603_163748.jpg", // BNF Towers
                        desc: "Dominique Perrault’s Bibliothèque Nationale de France redefines the urban void. Four L-shaped glass towers frame a sunken forest, creating an inward-looking microclimate that isolates reading rooms from the city's noise. The minimal glass envelopes emphasize transparency while the central garden acts as the project’s green lung." 
                    },
                    { 
                        t: "Structural Contrast", 
                        img: "paris/20250603_192333.jpg", // Louvre Pyramid
                        desc: "I.M. Pei’s Pyramid is a masterclass in structural tension and transparency. The cable-stayed glass structure creates a dialogue between the historic Renaissance palace and modern engineering. It serves as a luminous skylight for the subterranean lobby, demonstrating how minimal intervention can activate vast underground volumes." 
                    }
            ]
        },
        {
                id: "04", 
                city: "Zefco", 
                intro: "During a Paris study trip with Cardiff University’s Environmental Design and Sustainable Megabuildings MSc cohorts, led by Profs. Emmanouil Perisoglou and Amalia Banteli, I explored Zefco’s low-carbon designs integrating beauty and sustainability. Collaborating with experts like Sarah O'Dwyer, Vicki Stevenson, and others, I honed skills in environmentally responsive architecture for future-proof solutions.", 
                images: [
                    { 
                        t: "Lifecycle Assessment", 
                        img: "zefco/IMG-20250612-WA0017.jpg", // Bio-based materials slide
                        desc: "Analyzing the embodied carbon of construction materials. Zefco’s methodology emphasizes the critical shift from static performance metrics to dynamic lifecycle assessments (LCA), illustrating how bio-based materials can drastically reduce the carbon footprint of future developments." 
                    },
                    { 
                        t: "Circular Economy", 
                        img: "zefco/Screenshot_20251211_222949_LinkedIn.jpg", // Supply chain slide
                        desc: "Mapping the construction value chain to identify circular economy opportunities. The workshop highlighted the importance of 'urban mining' and material reuse, challenging the traditional linear 'take-make-waste' model in favor of a regenerative architectural ecosystem." 
                    },
                    { 
                        t: "Adaptive Reuse Strategy", 
                        img: "zefco/IMG-20250608-WA0073.jpg", // Presentation
                        desc: "Developing retrofit strategies for existing building stock. We explored interventions that upgrade thermal performance without compromising architectural integrity, proving that the most sustainable building is often the one that already exists." 
                    },
                    { 
                        t: "Collaborative Design", 
                        img: "zefco/IMG-20250604-WA0006.jpg", // Group in Courtyard
                        desc: "Interdisciplinary collaboration is at the heart of sustainable design. Working alongside peers and experts in the Zefco courtyard, we synthesized complex environmental data into actionable design solutions, bridging the gap between engineering metrics and architectural form." 
                    },
                    { 
                        t: "Retrofit Case Study", 
                        img: "zefco/Screenshot_20251211_222938_LinkedIn.jpg", // Blue/White Building
                        desc: "On-site analysis of a Zefco retrofit project. This case study demonstrated the practical application of external thermal insulation composite systems (ETICS) to modernize mid-century housing, significantly reducing operational energy demand while refreshing the urban aesthetic." 
                    },
                    { 
                        t: "Low-Carbon Workshop", 
                        img: "zefco/IMG-20250612-WA0033.jpg", // Interior Workshop
                        desc: "Inside the Zefco studio, engaging with the tools and materials of low-carbon design. This immersive environment fostered a deep understanding of how material selection, from hempcrete to cross-laminated timber (CLT), dictates the environmental success of a project." 
                    }
                ]
        }
        ];

        let pageFlip = null;

        function openDiary(index) {
            const data = diaries[index];
            const bookEl = document.getElementById('flipbook');
            
            // Switch Views
            document.getElementById('landing-view').classList.add('hidden');
            document.getElementById('book-view').classList.remove('hidden');
            document.getElementById('global-exit-btn').classList.remove('hidden');
            document.getElementById('main-nav').classList.add('hidden');

            // --- BUILD HTML PAGES ---
            // Note: Added 'anim-element' class to text we want to animate
            let html = `
                <div class="my-page --hard"><div class="cover-content"><div class="cover-sub">DIARY ${data.id}</div><div class="cover-title">${data.city}</div></div></div>
                <div class="my-page" style="background:#222;"></div>
                <div class="my-page">
                    <div class="text-page-container">
                        <div class="anim-element" style="font-size:1.5rem;border-bottom:1px solid #c9b29a;margin-bottom:1rem;">${data.city}</div>
                        <p class="anim-element anim-delay-1" style="font-size:0.9rem;font-style:italic;color:#666;line-height:1.6;">${data.intro}</p>
                    </div>
                </div>
            `;
            
            data.images.forEach(img => {
                html += `
                <div class="my-page">
                    <img src="${img.img}" class="page-image-full">
                    <div class="caption-box anim-element">
                        <h3>${img.t}</h3>
                        <p>${img.desc}</p>
                    </div>
                </div>`;
            });
            
            html += `<div class="my-page --hard"><div class="cover-content"><div class="cover-sub">End</div></div></div>`;
            bookEl.innerHTML = html;

            // --- MOBILE RESPONSIVE LOGIC ---
            const isMobile = window.innerWidth < 768;
            
            const settings = {
                width: isMobile ? 300 : 400,
                height: isMobile ? 450 : 600,
                size: "fixed",
                minWidth: 200, maxWidth: 800, minHeight: 300, maxHeight: 900,
                showCover: true, 
                maxShadowOpacity: 0.5,
                usePortrait: isMobile, // Single Page on Mobile
                startPage: 0
            };

            // Init Book
            setTimeout(() => {
                if (pageFlip) { try { pageFlip.destroy(); } catch(e){} }
                
                pageFlip = new St.PageFlip(bookEl, settings);
                pageFlip.loadFromHTML(document.querySelectorAll('.my-page'));

                // ANIMATION TRIGGER
                // We listen for the 'flip' event to toggle the 'active-page' class
                const triggerAnimation = () => {
                    const pages = document.querySelectorAll('.my-page');
                    // Reset all
                    pages.forEach(p => p.classList.remove('active-page'));
                    
                    // Get current visible indices
                    // Note: pageFlip.getCurrentPageIndex() returns the index of the left page (or single page)
                    const currentIdx = pageFlip.getCurrentPageIndex();
                    
                    // Activate current page (and next if double view)
                    if (pages[currentIdx]) pages[currentIdx].classList.add('active-page');
                    
                    // If desktop mode (double page), activate neighbor too
                    if (!isMobile && pages[currentIdx + 1]) {
                        pages[currentIdx + 1].classList.add('active-page');
                    }
                };

                // Controls Logic
                const updateUI = () => {
                    const current = pageFlip.getCurrentPageIndex();
                    document.getElementById('pageCount').innerText = (current===0)?"Cover":`Page ${current}`;
                    document.getElementById('btnPrev').disabled = (current===0);
                    triggerAnimation(); // Trigger anim on flip
                };

                pageFlip.on('flip', updateUI);
                
                // Trigger initial animation
                setTimeout(triggerAnimation, 500);
                updateUI();

                document.getElementById('btnPrev').onclick = () => pageFlip.flipPrev();
                document.getElementById('btnNext').onclick = () => pageFlip.flipNext();
            }, 100);
        }

        function closeDiary() {
            location.reload();
        }

        // --- MENU LOGIC ---
        const trigger = document.getElementById('menu-trigger');
        const closeBtn = document.getElementById('menu-close');
        const menu = document.getElementById('fs-menu');
        const links = document.querySelectorAll('.menu-link');

        if(trigger){
            trigger.onclick = () => {
                menu.classList.add('menu-open');
                links.forEach((l,i) => setTimeout(() => l.classList.add('slide-in'), 300 + i*100));
            };
            closeBtn.onclick = () => {
                menu.classList.remove('menu-open');
                links.forEach(l => l.classList.remove('slide-in'));
            };
        }

        // --- NAVBAR SCROLL ---
        let lastScrollTop = 0;
        const navbar = document.getElementById('main-nav');
        window.addEventListener('scroll', function() {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (scrollTop < 0) return;
            if (scrollTop > lastScrollTop && scrollTop > 50) {
                navbar.classList.add('nav-hidden');
            } else {
                navbar.classList.remove('nav-hidden');
            }
            lastScrollTop = scrollTop;
        });
    </script>
</body>
</html>